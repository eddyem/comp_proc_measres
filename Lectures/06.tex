\lr{Анализ временных рядов. Фурье-- и Вейвлет--анализ}
\subsection{Аппроксимация и интерполяция}
Одним из распространенных и практически важных случаев связи между
аргументом и функцией является задание этой связи в виде некоторой таблицы
$(x_i, y_i)$. В таком виде обычно задаются экспериментальные данные.

На практике часто приходится
использовать табличные данные для приближенного вычисления~$у$ при любом
значении аргумента~$х$ (из некоторой области). Этой цели служит задача
приближения (\bf{}аппроксимации\rm)\index{Аппроксимация} функций:\к заданную
таблично функцию $f(x)$ требуется
приближенно заменить некоторой функцией~$g(x)$ так, чтобы отклонение~$g(x)$
от~$f(x)$ в
заданной области было наименьшим\н. Функция~$g(x)$ при этом называется\ж
аппроксимирующей\н. Если приближение строится на заданном дискретном
множестве точек~$\{x_i\}$, то аппроксимация называется\к точечной\н. К ней
относятся
интерполирование, среднеквадратичное приближение и др. При построении
приближения на непрерывном множестве точек (например, на отрезке~$[a, b]$)
аппроксимация называется\к непрерывной или интегральной\н.

Для восстановления промежуточных значений функции, заданной таблично,
используются различные алгоритмы\ж интерполяции\н\index{Интерполяция}.
Простейшей является\ж линейная интерполяция\н.
При этом функция в промежутках между заданными точками интерполируется отрезками
прямых
линий. Данный вид интерполяции обладает значительной погрешностью, особенно для
быстро
изменяющихся функций при редком расположении контрольных точек. Разложим функцию
в ряд
Тейлора
$$f(x)=f(x_0)+(x-x_0)f'(x_0)+\cdots+\frac{(x-x_0)^nf^{(n)}(x_0)}{n!}+R_n$$
и ограничимся нулевым и первым членами разложения. Тогда на каждом отрезке
$[x_n,x_{n+1}]$
функцию можно задать в виде
$$f_n(x)=y_n+(x-x_n)\frac{y_{n+1}-y_n}{x_{n+1}-x_n},$$
где $y_n$~-- табличное значение функции в точке~$x_n$.
Значительно меньшую погрешность имеет\к интерполяция сплайнами\н.

\bf Сплайн\н\index{Сплайн}~--- кусочная полиномиальная функция, которая на
заданном отрезке
может принимать
очень простую форму, в то же время имея гибкость и гладкость.
Чаще всего для интерполяции функций используются\к кубические сплайны\н,
представляющие
собой набор полиномов третьей степени~$p_n(x)$, проходящих через заданные точки.
На точках сшивания,
в которых один сплайн переходит в другой, на сплайны накладываются следующие
ограничения:
\begin{itemize}
\item предыдущий сплайн должен переходить в следующий в точках сшивания, т.е.
$p_n(x_n)=p_{n+1}(x_n)$;
\item интерполированная функция должна быть гладкой, т.е.
$p'_n(x_n)=p'_{n+1}(x_n)$;
\item точки сшивания являются точками перегиба, т.е.
$p''_n(x_n)=0$ для всех~$n$.
\end{itemize}
Таким образом, для полиномов $p_n$, определенных на~$N-1$ отрезке имеем $4N-4$
коэффициентов. Граничные условия дают для этих коэффициентов~$3N-4$ уравнения.
Недостающие~$N$ уравнений можно получить из дополнительных условий.

Однако, для квадратичных сплайнов перечисленных условий достаточно для
формирования системы уравнений, из которой могут быть найдены все коэффициенты.

В двумерном пространстве аналогом кубических сплайнов является\ж пластинчатый
сплайн\н~---
поверхность, проходящая через узловые точки и минимизирующая энергию сгиба
$$I[f(x,y)]=\iint_\mathbb{R}(f_{xx}^2+2f_{xy}^2+f_{yy}^2)\,dx\,dy.$$

\subsection{Преобразования Лапласа, Z--преобразования}
В линейной теории управления аналогами преобразований Фурье выступают
преобразования Лапласа и Z--преобразования.
% Для любой бесконечной последовательности данных $x_k$\ж
% z-преобразование\н\index{Z-преобразование} определяется следующим образом:
% $$X(z)=\sum_{k=-\infty}^\infty x_k z^{-k}.$$
% Здесь $z$ представляет собой непрерывную комплексную переменную, а $X(z)$
% называют двусторонним z-преобразованием. Если последовательность $x_k$
% является
% полубесконечной, z-преобразование является односторонним.
%
% $Z$-преобразования применяются при анализе цифровых систем (для анализа
% непрерывных систем используются преобразования Лапласа). Цифровая система
% представляется обычно в виде черного ящика, на вход которого подается сигнал
% $x$, а с выхода снимается сигнал $y$. Выходной сигнал выражается через входной
% и\ж передаточную функцию\н~$H$\index{Функция!передаточная} посредством
% $z$-преобразований:
% $$Y(z)=H(z)X(z).$$
%
% Простая замена $z$ на $\e^{2\pi i\omega}$ позволяет из $z$-преобразования
% получить дискретное преобразование Фурье.

\paragraph{Преобразования Лапласа}\index{Преобразование!Лапласа}  комплексного
переменного $s$ определяются как:
\begin{equation*}
F(s)=\LT{f(t)}(s)=\Int_0^{\infty}f(t)\e^{-st}dt.
\label{Laplas_transform}
\end{equation*}
Использование преобразований Лапласа имеет тот смысл, что управляющая
функция $f(t)$ чаще всего является чисто действительной, а ее
состояние в момент времени $t<0$ не определено или же не
интересует исследователя.

Преобразование Лапласа связано с
Фурье-преобразованием\index{Преобразование!Фурье}
\begin{equation*}
\FT{F}\equiv F(u)=\Infint f(x)\e^{-2\pi i ux}\,dx
\label{Fourier_transform}
\end{equation*}
простым соотношением:
$$\LT{f(t)}(2\pi f)=\Int_0^{\infty}f(t)\e^{-2\pi ift}dt=\FT{f(t)},$$
если $f(t)=0$ при $t<0$. Таким образом, получить преобразование
Фурье из преобразования Лапласа можно заменой переменной $s$ на
$2\pi if$, что позволяет использовать для преобразований Лапласа
все свойства преобразований Фурье. Одним из замечательных свойств
является следующее:
$$\LT{\dfrac{df(t)}{dt}}(s)=s^{-1}\LT{f(t)}(s)\quad\Arr\quad\LT{f^{(n)}(t)}
(s)=s^{-n}\LT{f(t)},$$
которое позволяет привести линейные дифференциальные
уравнения к виду линейных алгебраических выражений.

Пусть $i(t)$~--- входной сигнал управляющей системы, $o(t)$~---
ее выходной сигнал, $I(s)$ и $O(s)$~--- их преобразования Лапласа
соответственно. Тогда\к передаточная функция\н\index{Функция!передаточная}
системы с нулевыми начальными условиями примет вид
\begin{equation*}
T(s)=\frac{O(s)}{I(s)}.
\label{Transfer_f}
\end{equation*}
Передаточная функция $T(s)$ описывает динамику системы,
совершенно отвлекаясь от ее внутреннего функционирования.

Зная входной сигнал и передаточную функцию системы, можно получить
выходной сигнал:
$$o(t)=\ILT{T(s)\LT{i(t)}(s)}(t),$$
где $\ILT{f(s)}(t)$~--- обратное преобразование Лапласа.

\paragraph{Z--преобразования.}
Итак, преобразования Лапласа упрощают расчеты моделей управляющих
аналоговых систем. В моделях же управляющих цифровых систем мы
имеем дело с дискретными сигналами, то есть вместо преобразований
Лапласа здесь необходимо применять их дискретные аналоги~---
Z--преобразования.

Z--преобразование дискретного сигнала $\mathrm{i}={i_k}$, где
$k=0,\ldots,\infty$,
имеет следующий вид:
\begin{equation*}
I(s)\equiv\ZT{\mathrm{i}(t)}(s)=\sum_{k=0}^\infty i_k(t)z^{-k},
\label{Z_transform}
\end{equation*}
где $z$~-- комплексная переменная, выбранная так, чтобы Z--преобразование
сходилось.

Ряд $i_k(t)$ можно получить путем дискретизации аналогового сигнала
$i(t)$: $$i_k(t)=i(t)\delta(t-k\Delta t),\quad \Delta
t=t_k-t_{k-1}\mbox{ --- период дискретизации}.$$

Интересно обратить внимание на свойство $Z$-преобразования временн\'ого
сдвига функции, похожего на преобразование Лапласа $n$-й производной:
$$\ZT{\mathrm{i}(t+n\Delta t)}=z^n\ZT{\mathrm{i}(t)}.$$
Кроме того, при $t\ll\Delta T$ можно указать следующую связь преобразования
Лапласа и $Z$-преобразования:
$$\LT{\mathrm{i}(t)}(s)=\ZT{\mathrm{i}(t)}\e^{-st}.$$


\subsection{Фурье--анализ}
При работе с гармоническими функциями, а также при определении спектра сигнала
используются
ряды Фурье.\ж Ряд Фурье\н\index{Ряд Фурье} представляет собой бесконечный ряд с
членами~--- гармоническими функциями
$$f(x)=\sum_{n=0}^\infty a'_n\cos(nx)+\sum_{n=0}^\infty b'_n\sin(nx).$$
Коэффициенты $a_n$ и~$b_n$ рассчитываются по формулам
$$a_n=\rev\pi\Int_{-\pi}^\pi f(x)\cos(nx)\,dx,\qquad
b_n=\rev\pi\Int_{-\pi}^\pi f(x)\sin(nx)\,dx.$$

При разложении функции в ряд Фурье необходимо помнить, что функция при этом
определена на конечном отрезке. Вне этого отрезка функция будет повторяться, как
периодическая. наилучшим образом разложению в ряд Фурье поддаются гармонические
и псевдогармонические функции, при этом получается конечное число членов ряда.

При разложении временн\'ого ряда в ряд Фурье следует помнить, что если первая
компонента соответствует элементарному колебанию колебанию с заданной частотой,
остальные компоненты представляют собой высшие гармоники данного колебания,
расположенные синфазно основному (косинусные члены) и со сдвигом на~$90\degr$
(синусные члены). Значит, коэффициенты Фурье представляют собой амплитуды
элементарных колебаний, составляющих суммарный сигнал.

Получение набора коэффициентов $a_n$ и~$b_n$ на дискретном множестве точек
и восстановление функции при помощи ряда
Фурье называют\ж дискретным преобразованием Фурье\н~(ДПФ). Недостаток ДПФ в том,
что при
ограничении количества членов ряда результирующая функция заметно искажается.


\begin{pict}
\includegraphics[width=\textwidth]{pic/FM-AM}
\caption{Спектры ЧМ~(сверху) и АМ~(снизу) сигналов, образованных из двух
одинаковых гармонических сигналов}
\label{SNR}
\end{pict}


\bf Непрерывное преобразование Фурье\н задается формулами
$$F(k)=\FT{f(x)}\equiv\Infint f(x)\e^{-2\pi ikx}\,dx,\quad
f(x)=\IFT{F(k)}\equiv\rev{2\pi}\Infint F(k)\e^{2\pi ikx}\,dk.$$
$\FT{f}$ называют\к прямым\н, а $\IFT{F}$~---\к обратным преобразованием
Фурье\н.
Физическая величина~$k$ имеет обратную по отношению к~$x$ размерность.
Следовательно,
если~$x$ имеет значение времени, $k$~является частотой; если $x$~-- координата,
$k$~-- пространственная частота.
Эта особенность позволяет применять Фурье--преобразования в спектральном анализе
сигналов и изображений. Спектр сигнала совпадает с его преобразованием Фурье.
Для сигнала, полученного смешиванием нескольких гармонических сигналов,
посредством преобразований Фурье возможно определить частоту основной и побочных
гармоник~\look{FourSP}.

\begin{pict}
\includegraphics[width=.7\textwidth]{pic/FourSP}
\caption{Спектр сигнала с амплитудной модуляцией (отмечен точками),
спектр этого же сигнала с зашумлением. Границы спектральной фильтрации
(отсекается высокочастотная область) отмечены вертикальными линиями}
\label{FourSP}
\end{pict}

Фурье--анализ применяется и для\к фильтрации сигналов\н\index{Фильтрация!Фурье}.
Например, для отсечения высокочастотной составляющей необходимо умножить спектр
сигнала на функцию--ступеньку, значения которой до граничной частоты~$f_0$
равно~1, а после нее~0. Последующее обратное преобразование Фурье
преобразованного таким образом спектра позволит получить отфильтрованный
сигнал~\look{Four-filter}.

\begin{pict}
\includegraphics[width=\textwidth]{pic/Four-filter}
\caption{Пример Фурье--фильтрации сигнала (спектры сигналов изображены на
рис.~\ref{FourSP}. Точками обозначен оригинальный сигнал, линией~---
зашумленный сигнал, кружками~--- отфильтрованный}
\label{Four-filter}
\end{pict}


Удобна Фурье--фильтрация и для преобразования изображений. В этом случае~$x$
имеет размерность радиус--вектора заданной точки изображения, а~$k$~---
пространственной частоты. Примерной аналогией пространственной частоты является
количество штрихов на изображении, расположенных поперек заданного
направления~$\vec k$. Таким образом, например, для удаления из изображения помех
можно отсечь высокочастотную составляющую его Фурье--образа. Для этого на образе
заменяем нулями значения~$F(x)$ во всех точках, лежащих вне окружности заданного
радиуса с центром в центре образа. Чем меньше радиус такой окружности, тем на
более низких частотах будет происходить фильтрация. Отрицательной стороной такой
фильтрации является потеря высокочастотных деталей изображения (мелких деталей,
штриховок).

Так как свертка сигналов по свойству преобразования Фурье является произведением
образов этих сигналов, $a(t)\otimes b(t)\equiv \FT{a}\cdot\FT{b}=A(\nu)\cdot
B(\nu)$,
преобразования Фурье широко используются в оптике и спектроскопии. Любой
оптический прибор можно рассматривать как черный ящик, в котором происходит
преобразование Фурье входного сигнала~$f(t)$, умножение его на аппаратную
функцию
прибора~$A(\nu)$ (фурье--образ передаточной функции прибора), зашумление (т.е.
умножение
на функцию $1+\delta(\nu)$, где $\delta$~-- случайная функция, характеризующая
спектральную мощность шума), обратное преобразование Фурье:
$$\B{f(t)}\;\Arr\; \FT{f(t)}\equiv F(\nu)\;\Arr\;
B(\nu)=F(\nu)\cdot A(\nu)\;\Arr$$
$$\Arr\; N(\nu)=B(\nu)\cdot(1+\delta(\nu))\;\Arr\;
\B{f}'(t)\equiv{\IFT{N(\nu)}}.$$

Спектральный прибор осуществляет пространственное перераспределение входящего
излучения, так что выходной сигнал является еще и функцией координаты
светоприемника.
В этом случае прибор производит преобразование частотной координаты
Фурье--спектра
к пространственному виду:
$$\B{f(t)}\;\Arr\; \FT{f(t)}\equiv F(\nu)\;\Arr\;
B(\nu)=F(\nu)\cdot A(\nu)\;\Arr$$
$$\Arr\; N(\nu)=B(\nu)\cdot(1+\delta(\nu))\;\Arr\;\nu\to x\;\Arr\;
\B{S}(x).$$

\subsection{Вейвлет--анализ}
Преобразования Фурье основаны на разложении функции по ортогональному\к
гармоническому\н базису, не имеющему временн\'ой локализации, но зато четко
локализованном пространственно. Это обстоятельство делает преобразование Фурье
прекрасным инструментом для анализа сигналов, не меняющих свои свойства с
течением времени, в то же время не позволяя анализировать иррегулярные функции.

Для исследования иррегулярных кусочных функций необходимы преобразования,
основанные на базисе функций, имеющих четкую временн\'ую и масштабную
локализацию, т.е. масштабируемых функций, принимающих ненулевые значения лишь в
конечной области значений аргумента.

В середине прошлого века в математике появились новые методы анализа и
восстановления функций~---
использование вейвлетов (wavelet, в отечественной математике~---\к
функция--всплеск\н).\ж
Вейвлеты\н\index{Вейвлет}~--- класс функций, использующихся для пространственной
и масштабируемой локализации
заданной функции. Семейство вейвлетов может быть образовано из функции~$\psi(x)$
(ее иногда
называют <<материнским вейвлетом>>), ограниченной на конечном интервале.
<<Дочерние>>
вейвлеты
$\psi^{a,b}(x)$ образуются из <<материнского>> путем сдвига и масштабирования.

Вейвлеты широко используются для сжатия изображений, так как они обладают более
гибкими свойствами по сравнению с преобразованием Фурье. Так, например, если
изображение обладает резкими границами, Фурье--образ этого изображения дает\ж
краевые эффекты\н~--- полученная ступенька сглаживается, что искажает границы
изображения, восстановленного из Фурье--образа.

Отдельный вейвлет можно определить как
$$\psi^{a,b}(x)=|a|^{-1/2}\psi\Bigl(\frac{x-b}{a}\Bigr).$$
Тогда\ж базис вейвлетов\н (\it{}прямое вейвлет--преобразование\н),
соответствующих функции~$f(x)$ определяется как
$$W_\psi(f)(a,b)=\rev{\sqrt a}\Infint f(t)\psi\Bigl(\frac{t-b}{a}\Bigr)\,dt.
\label{waveletb}$$
где $a, b\in \mathbb{R}$, $a\ne0$.

Преобразование Фурье является корреляцией между исходным сигналом и набором
волн, поэтому является функцией одной переменной~--- частоты.
Вейвлет--преобразование является корреляцией между исходным сигналом и набором
фукнций--всплесков, характеризуемых масштабом~$a$ и временн\'ой
локализацией~$b$. Поэтому вейвлет--преобразования являются функциями двух
аргументов: масштаба вейвлета и его положения на оси времени.

Итак, вейвлеты являются локализованными как во времени,
так и по частоте. Временн\'ая локализация означает, что вся энергия
вейвлета сосредоточена в конечном интервале и быстро убывает относительно
центра масс вейвлета. Частотная локализация вейвлета означает ограниченность
частотного диапазона данной функции.

Базис вейвлетов, в отличие от гармонических функций, однозначно сворачивается с
любыми непрерывными функциями. Для кусочных фукнций и функций, имеющих разрывы,
наилучшим методом анализа является только вейвлет--анализ.

В\ж вейвлет--анализе\н\index{Вейвлет--анализ} важным условием является
ортогональность базиса вейвлетов, по которым раскладывается функция. Строго
говоря, разложить функцию по базису вейвлетов и исследовать это разложение
можно и при неортогональности базиса. Однако, для однозначного восстановления
функции из ее вейвлет--разложения требуется, чтобы базис исходных вейвлетов был
ортогонален.

\it Обратное вейвлет--преобразование\н задается выражением
$$f(t)=C_\psi^{-1}\Infint W(a,b)\psi\Bigl(\frac{t-b}{a}\Bigr)
\rev{\sqrt a}\frac{da\,db}{a^2},$$
где $C_\psi$~-- нормирующий коэффициент.


Одним из известных семейств вейвлетов являются\ж вейвлеты Хаара\н, построенные
по аналогии с матричным\к преобразованием Адамара\н (за это их называют также
вейвлетами Адамара--Хаара). <<Материнский>> вейвлет Хаара имеет вид
$$\psi(x)=\begin{cases}
1,  & 0\le x\le 1/2;\\
-1, & 1/2< x\le 1;\\
0,  & \text{в других случаях.}
\end{cases}
$$
Функция масштабирования имеет вид
$$\phi(x)=\begin{cases}
1,& 0<x<1;\\
0,& \text{в других случаях.}
\end{cases}
$$
<<Дочерние>> вейвлеты задаются выражением
$$\psi^{j,k}(x)= 2^{j/2}\psi(2^j x-k),\qquad
\phi^{j,k}(x)= 2^{j/2}\phi(2^j x-k).$$
Нетрудно заметить, что вейвлеты Хаара являются ортогональными:
$$\langle\psi(x),\phi(x)\rangle=\Infint\psi^*(x)\phi(x)\,dx=0.$$

\begin{pict}
\includegraphics[width=\textwidth]{pic/Wave-filter}
\caption{Сравнение вейвлет--фильтрации (декомпозиция вейвлетами Мейера на пятом
уровне с восстановлением по пятому аппроксимирующему коэффициенту). Линией
обозначен оригинальный сигнал, точками~--- образец Фурье--фильтрации
зашумленного сигнала, кружками~--- образец вейвлет--фильтрации}
\label{Wave-filter}
\end{pict}

Вейвлет--фильтрация\index{Фильтрация!вейвлет} имеет б\'ольшую гибкость по
сравнению с
Фурье--филь\-тра\-цией.
Удаляя из вейвлет--образа члены с определенным масштабом можно исключить
шумы из сигнала~\look{Wave-filter}. Однако, если Фурье--фильтрация позволяет
исключить только
шум, подчиняющийся гармоническому закону, вейвлет--фильтрация очищает сигнал
практически от любого шума (необходимо только правильно подобрать базис
вейвлетов).
