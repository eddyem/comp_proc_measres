\lr{Обработка изображений}
\subsection{Цифровые изображения}
Изображение представляет собой двумерную функцию $f(x,y)$, где~$x$ и~$y$~---
пространственные координаты, а уровень~$f$ называется\ж
интенсивностью\н\index{Интенсивность} или\ж
уровнем серого\н изображения в данной точке (цветное изображение является
совокупностью по крайней мере трех функций $r(x,y)$, $g(x,y)$ и~$b(x,y)$).
Если величины~$x$, $y$ и~$f$ принимают дискретные значения, говорят о\к цифровом
изображении\н. Элементарная единица цифрового изображения называется\ж
пикселем\н\index{Пиксель} (pixel~--- picture element).
Под\к цифровой обработкой изображений\н подразумевается обработка
цифровых изображений с помощью~ЭВМ.

В отличие от человека, чье зрение приспособлено лишь к сравнительно узкому
частотному диапазону, ЭВМ все равно, каковы частоты в обрабатываемом ею
изображении.
Т.е. к цифровым изображениям следует относить также: ультразвуковые,
рентгеновские, электронные (микроскопия), магнитнорезонансные (томография) и
прочие изображения.

Несмотря на то, что в окружающем нас мире нет ничего непрерывного (абсолютно все
в нашей Вселенной подвержено квантованию), на уровне классической физики
основные наблюдаемые можно считать непрерывными, т.к. по сравнению с их
величиной величина кванта наблюдаемой пренебрежимо мала (сравните средний рост
человека и квант пространства). Однако, даже самый современный суперкомпьютер по
своей производительности не может сравниться с человеческим мозгом. Поэтому для
обработки изображения при помощи компьютера его необходимо\ж
квантовать\н\index{Квантование}, т.е. преобразовать из
квазинепрерывной формы в дискретную. Квантование производится как в пространстве
координат, так и в пространстве амплитуд. Следовательно, процедуру квантования
(\it{}дискретизации\rm) квазинепрерывного изображения $I_0(X,Y)$ в его
дискретную форму $I(x,y)$ можно представить в виде:
\begin{equation*}
I(x,y)=\mathrm{round}\Bigl(\frac{2^N-1}{I_{max}}\Int_{S_{x,y}}I_0(X,Y)
\,dX\,dY\Bigr)+\delta_{x,y}.
\label{Disk_ima}
\end{equation*}

Здесь $I_{max}$~-- максимальная интенсивность дискретизуемого сигнала, $N$~--
разрядность
по интенсивности, интегрирование ведется по площади пикселя с
координатами~$(x,y)$,
$\delta_{x,y}$~-- шум дискретизации, возникающий при преобразовании сигнала.

Цифровому изображению соответствует матрица. Если изображение серое, матрица
двумерная. Координаты изображения отсчитываются от первого элемента матрицы,
первая координата~$(x)$ соответствует номеру строки матрицы, вторая~---
номеру~$(y)$ столбца. Цветному изображению соответствует трехмерная матрица, в
которой каждый из слоев соответствует цветовой компоненте~R, G или~B.

RGB--модель изображения является наиболее распространенной в силу
физиологических особенностей человеческого зрения и строения
электроннолучевых трубок (каждый пиксель которых состоит из комбинации трех
люминофоров). Однако, существуют и другие цветовые модели, например, модель
CMYK. В отличие от аддитивной RGB--модели, CMYK--модель является
субстрактивной, т.е. если в RGB--модели смешиваются световые лучи с разной
спектральной характеристикой, то в CMYK--модели вычитаются цветовые компоненты
(как при смешивании красок на палитре художника).

Преобразовать изображение в CMYK--пространство необходимо при распечатывании
его на плоттере или цветном принтере. Преобразование изображения в
CMY--пространство выполняется довольно просто:
$$[C\;M\;Y]=[1\;1\;1]-[R\;G\;B]$$
(предполагается, что цветовые компоненты нормированы на единицу).
Теоретически, при равном смешении голубого~(C), пурпурного~(M) и желтого~(Y)
красителей должен получиться один из оттенков серого. Однако, на практике,
полученный таким образом черный выглядит довольно блекло, поэтому в
цветные принтеры добавляется еще один краситель~--- черный~(K).
Следовательно, при преобразовании RGB--изображения в CMYK--пространство
пиксели, в которых уровни исходных цветовых компонент совпадают (т.е.
градации серого цвета) необходимо преобразовывать по формуле
$$K=1-\frac{R+G+B}{3}\Bigr|_{R=G=B},$$
а у остальных пикселей цветовые компоненты преобразуются по вышеприведенной
формуле.

\subsection{Преобразования в пространственной области}
Простейшими методами преобразования изображений являются манипуляции в\к
пространственной области\н, т.е. непосредственные операции с пикселями
изображений, которые можно обозначить выражением $g(x,y)=T[f(x,y)]$, где
$T$~-- некоторый оператор над изображением. Оператор~$T$ может применяться
как ко всему изображению, так и к окрестности отдельной точки~$(x_0,y_0)$.
Оператор~$T$ принимает простейший вид при линейных преобразованиях яркости
изображения: $g(x,y)=\lambda\cdot f(x,y)$, либо же при более сложных
функциональных
зависимостях,\к одинаковых для всех пикселей изображения\н.

Некоторые типы изображений для более наглядного отображения необходимо
логарифмировать. Человеческие органы чувств работают в шкале логарифмов
возмущений (именно поэтому мощности сигналов по отношению к воздействию на
человеческие органы чувств принято измерять в децибеллах), поэтому в
логарифмической шкале некоторые изображения могут выглядеть значительно четче.
Логарифмические преобразования выполняются при помощи выражения
$$g(x,y)=\C\ln\bigl(1+f(x,y)\bigr).$$
Основное применение логарифмического преобразования состоит в сжатии
динамического диапазона. Особенно полезным является логарифмическое
преобразование Фурье--спектра изображения (т.к. динамический диапазон
Фурье--спектра может быть довольно значительным и его линейное преобразование не
позволит в должной степени отразить переходы между величинами повышенной и
пониженной амплитуд).

Еще одним примером преобразований в пространственной области является\к
преобразование растяжения контрастности\н. Оператор~$T$ сжимает входные уровни
яркости, меньшие порогового значения~$m$ в узкий диапазон уровня темного на
выходном изображении, а величины, большие~$m$~--- в более узкую полосу уровня
светлого. Оператор преобразования растяжения контрастности имеет вид
$$T(r)=\rev{1+(m/r)^E},$$
где $r$~-- уровень яркости входного изображения, $m$~-- заданное пороговое
значение, $E$~-- коэффициент, влияющий на наклон функции в области порогового
значения. При $E=\infty$ оператор~$T$ называют\к пороговым\н, т.к. он
приравнивает к нулю яркость всех пикселей изображения, если на исходном их
уровень яркости был меньше порогового. Остальные уровни яркости приравниваются
к единице.

Для коррекции изображений зачастую применяется матричная пространственная
фильтрация, заключающаяся в свертке исходного изображения с некоторой маской,
задающей фильтр. Так, например, фильтр Лапласа, позволяющий получить лапласиан
исходного изображения, реализуется при помощи свертки с маской
$\small\left(\begin{smallmatrix}
0&1&0\\1&-4&1\\0&1&0
\end{smallmatrix}\right)$,
которая получается из дискретного приближения второй производной.

\begin{pict}
\includegraphics[width=.33\textwidth]{pic/Noiced}\hspace*{2pt}
\includegraphics[width=.33\textwidth]{pic/MF3}\hspace*{2pt}
\includegraphics[width=.33\textwidth]{pic/MF5}
\caption{Медианная фильтрация. Слева приведено изображение с шумом типа <<соль и перец>>.
В центре~--- после медианной фильтрации $3\times3$~точки. Справа~--- после медианной
фильтрации $5\times5$~точек. Заметна потеря разрешения изображения в результате
фильтрации}
\label{MedFilt}
\end{pict}

\it Нелинейные фильтры\н определяют значение пикселя нового изображения исходя
из результата упорядочивания значений в некоторой окрестности соответствующего
пикселя исходного изображения. Самым известным из нелинейных фильтров является
медианный фильтр, позволяющий бороться с импульсными шумами <<соль и перец>>
(данный шум изменяет значения яркости в некоторых точках изображения так, что
они принимают нулевое либо максимальное значение)~\look{MedFilt}.

\subsection{Гистограмма}\index{Гистограмма}
\bf Гистограммой\н цифрового изображения, число возможных уровней яркости~$L$
которого лежит в диапазоне~$[0,G]$, называется дискретная функция~$h(r_k)=n_k$,
где $r_k$~-- $k$-й уровень яркости, $n_k$~-- число пикселей изображения с
уровнем яркости~$r_k$. Часто бывает удобно работать с\к нормированными
гистограммами\н, которые получаются делением~$h(r_k)$ на общее количество
пикселей изображения: $p_r(r_k)=h(r_k)/n$. В этом случае гистограмма определяет
вероятность появления уровня интенсивности~$r_k$ в данном изображении.

Отображать гистограмму графически удобнее всего при помощи столбцевых диаграмм,
когда каждому уровню яркости соответствует отдельный столбец диаграммы с
высотой, равной~$h(r_k)$.

\begin{pict}
\includegraphics[width=.45\textwidth]{pic/BadIma}
\hspace*{15pt}
\includegraphics[width=.45\textwidth]{pic/Hist}
\caption{Изображение, полученное с чрезмерной экспозицией (слева). Справа отображены
гистограммы: линиями с кружками~--- оригинального изображения, столбцами~--- после
эквализации гистограммы}
\label{BadIma}
\end{pict}

Изображения могут иметь низкий динамический диапазон, особенно если они получены
в неподходящих условиях съемки~\look{BadIma}. Для улучшения качества изображения можно
применять\ж эквализацию\н\index{Эквализация} его гистограммы. Эквализация
заключается в том, что гистограмма изображения расширяется на весь возможный
динамический диапазон яркостей. Т.е., минимальная яркость исходного изображения
заменяется на нуль, а максимальная~--- на предельное значение яркости. Остальные
величины яркости равномерно распределяются в расширенном динамическом диапазоне
в соответствии с первоначальной гистограммой~\look{HistEq}.

Эквализация гистограммы цифрового изображения задается выражением
$$s_k\equiv T(r_k)=\sum_{j=1}^k p_r(r_j)=\rev{n}\sum_{j=1}^k h(r_k),$$
где $s_k$~-- величина яркости выходного изображения, соответствующая значению
яркости~$r_k$ входного изображения.

\begin{pict}
\includegraphics[width=.45\textwidth]{pic/BadIma}
\hspace*{15pt}
\includegraphics[width=.45\textwidth]{pic/HistEq}
\caption{Исходное изображение (слева) и его копия после эквализации гистограммы (справа)}
\label{HistEq}
\end{pict}

Кроме гистограммной эквализации, существуют методы <<подгонки>> гистограммы,
когда гистограмма изображения подгоняется под заданную функцию, т.е. когда
уровни яркости отдельных пикселей меняются в соответствии с их положением на
новой гистограмме.

\subsection{Преобразования в частотной области}
\bf Двумерное дискретное преобразование
Фурье\н~\index{Преобразование!Фурье!двумерное}(ДПФ) изображения задается
выражением
$$F(u,v)=\sum_{x=0}^{M-1}\sum_{y=0}^{N-1}f(x,y)\e^{-2\pi i(\frac{ux}{M}+
\frac{vy}{N})},\; u=\overline{0,M-1},\;v=\overline{0,N-1}.$$
\bf Частотной областью\н называется координатная система, задающая аргументы
$F(u,v)$ частотными переменными~$u$ и~$v$. Здесь можно заметить аналогию с
заданием аргументов $f(x,y)$ пространственными переменными $x$ и~$y$.
Прямоугольную область $M\times N$, являющуюся областью определения
преобразования Фурье, принято называть\к частотным прямоугольником\н. Частотный
прямоугольник имеет те же размеры, что и исходное изображение.

Обратное ДПФ задается выражением
$$f(x,y)=\rev{MN}\sum_{u=0}^{M-1}\sum_{v=0}^{N-1}F(u,v)\e^{2\pi i(\frac{ux}{M}+
\frac{vy}{N})},\; x=\overline{0,M-1},\;y=\overline{0,N-1}.$$

Значение Фурье--образа изображения в точке $(0,0)$, т.е. в начале координат
частотного прямоугольника, соответствует постоянной компоненте изображения
(т.е. компоненте с нулевой пространственной частотой). Нетрудно заметить, что
это значение является произведением среднего арифметического уровня яркости
изображения на число~$MN$.

Даже если изображение~$f$ вещественно, его преобразование Фурье~$F$, как
правило, является комплексным. Для визуализации~$F$ используется вычисление
абсолютной величины этой функции (\bf{}спектра\н\index{Спектр} изображения).
Если обозначить действительную и мнимую части Фурье--образа изображения как
$\Re(F)$ и~$\Im(F)$, то спектр изображения задастся выражением
$$S(u,v)=|F(u,v)|=\sqrt{[\Re(F)]^2+[\Im(F)]^2}.$$

В полярных координатах Фурье--образ изображения можно представить как
$$F(u,v)=S(u,v)\exp\bigl(i\phi(u,v)\bigr),$$
где $\phi(u,v)=\arctg\bigl(\frac{\Im(F)}{\Re(F)}\bigr)$~--\к фазовый угол\н
спектра.

Так как исходное изображение является вещественной функцией, его Фурье--образ
сопряженно симметричен относительно начала координат, т.е. $F(u,v)=F^*(-u,-v)$,
что означает симметрию Фурье--спектра относительно начала координат:
$S(u,v)=S(-u,-v)$.

Фурье--образ изображения обладает периодичностью с периодом, равным размеру
изображения. Поэтому для большего удобства визуализации его можно привести к
системе координат с нулем в центре изображения. Для этого в спектре производится
перестановка первого и третьего квадрантов и второго и четвертого. Данная
операция аналогична умножению исходного изображения~$f(x,y)$ на $(-1)^{x+y}$\к
до\н вычисления преобразования Фурье.

Периодичность прямого и обратного преобразований Фурье зачастую приводит к
затруднениям, т.к. интуитивно не очевидно, что взятие обратного преобразования
Фурье приводит к периодической функции.

Фурье--фильтрация\index{Фильтрация} изображения формально ничем не отличается от
фильтрации одномерных сигналов. Т.е. если известна функция фильтра~$g(x,y)$,
фильтрованное изображение получается путем свертки
$$f'(x,y)=f(x,y)\otimes g(x,y),$$
или, учитывая свойства Фурье--преобразований,
$$f'(x,y)=\IFT{\FT{f(x,y)}\cdot\FT{g(x,y)}}=\IFT{F(u,v)G(u,v)}.$$
Функцию $G(u,v)$ принято называть\ж передаточной
функцией\н\index{Функция!передаточная} фильтра.

Основная идея фильтрации в частотной области заключается в подборе передаточной
функции фильтра, которая модифицирует Фурье--образ изображения требуемым
образом.

Фурье--преобразования некоторых периодических функций могут иметь артефакты,
называемые\ж краевыми эффектами\н\index{Краевые эффекты}: между смежными
периодами ДПФ могут возникнуть
эффекты интерференции, искажающие вид спектра изображения. Для избавления от
краевых эффектов следует дополнить изображение (размера $M\times N$) по краям
нулями, сформировав матрицу размером $P\times Q$, где $P\ge 2M-1$, $Q\ge2N-1$.
Алгоритм ДПФ работает быстрее, когда~$P$ и~$Q$ являются степенями двойки,
поэтому эти числа (особенно для больших изображений) стараются выбрать именно
исходя из критерия скорости.

Наиболее распространенными видами фильтрации в частотной области являются
низкочастотная~(НЧ) и высокочастотная~(ВЧ) фильтрация. При НЧ фильтрации
осуществляется размытие изображения (удаляются высокочастотные компоненты),
ВЧ фильтрация, наоборот, повышает резкость изображения (удаляются
низкочастотные компоненты).

Алгоритм фильтрации в частотной области состоит из следующих этапов:
\begin{enumerate}
\item получение размеров расширенного изображения и дополнение исходного
изображения нулями до требуемого размера;
\item построение преобразования Фурье с расширением;
\item генерирование функции фильтра~$G$, если исходный фильтр был центрирован,
до фильтрации необходимо привести его к исходной системе координат;
\item свертка фильтра и изображения в Фурье--пространстве:
\item выделение вещественной части обратного преобразования Фурье
образа отфильтрованного изображения;
\item выделение верхнего левого прямоугольника исходных размеров.
\end{enumerate}

Легко преобразовать НЧ фильтр в соответствующий ему ВЧ фильтр и наоборот. Пусть
$LP(u,v)$~-- передаточная функция НЧ фильтра, тогда передаточная функция
соответствующего
ему ВЧ фильтра вычисляется как $HP=1-LP$. Так как ВЧ фильтры отбрасывают нулевую
составляющую изображения (среднюю интенсивность), необходимо добавлять некоторое
смещение к отфильтрованному изображению. ВЧ усиление имеет передаточную
функцию $HP_E(u,v)=a+b\cdot HP(u,v)$, где $a$~-- смещение, $b$~-- коэффициент
усиления.

\subsection{Фильтрация шумов}
При получении изображения всегда используются реальные приборы, которые
неизменно добавляют к изображению тот или иной вид шума. Используя
свойства Фурье--преобразований, можно записать спектр полученного изображения
в виде
$$G(u,v)=H(u,v)F(u,v)+N(u,v)\;\Leftrightarrow\;
g(x,y)=h(x,y)\otimes f(x,y)+n(x,y).$$
Функция $h(x,y)$ называется\ж функцией рассеяния
точки\н\index{Функция!рассеяния точки} (ФРТ), а ее Фурье--образ
$H(u,v)$~---\ж оптической передаточной функцией\н\index{Функция!оптическая
передаточная} (ОПФ). Функция $n(x,y)$ характеризует шум.

Для оцифрованных изображений характерен периодический шум
$$n(x,y)=A\sin\Bigl[\rev{M}2\pi u_0(x+B_x)+\rev{N}2\pi v_0(y+B_y)\Bigr],$$
т.е. обратное Фурье--преобразование комплексно--сопряженных единичных импульсов,
находящихся в точках $(u_0,v_0)$ и~$-u_0,-v_0$. Параметры периодического шума
можно оценить по виду Фурье--спектра изображения: такой шум порождает частотные
всплески, которые можно обнаружить даже визуально. Кроме того, в данном случае
хорошие результаты дает исследование изображения при помощи его центральных
моментов. Наиболее часто используются первый нулевой (математическое ожидание)
и второй центральный (дисперсия) моменты.

Еще одним видом фильтрации является\к адаптивная медианная
фильтрация\н\index{Фильтрация!адаптивная}. Ее
отличие от <<обычной>> медианной фильтрации в том, что размер окрестности
текущего пикселя, по которой проводится усреднение, изменяется в зависимости
от содержимого этой окрестности. Чем более равномерным является распределение
интенсивности вокруг данной точки, тем большим будет размер окрестности
для фильтрации, и наоборот. Адаптивная медианная фильтрация помогает избавиться
от шумов типа <<соль и перец>>, не смазывая мелких деталей изображения.

Конечно, при наличии нескольких изображений одного и того же объекта, наилучшим
методом фильтрации шумов будет медианная фильтрация массива изображений (т.е.
каждое значение яркости пикселей итогового изображения является медианным
значением яркости исходных изображений в данном пикселе). В этом случае
количество информации, содержащееся в фильтрованном изображении, будет выше,
чем в исходных. Если же изображение единственно, любая фильтрация приведет к
уменьшению количества информации (даже адаптивная медианная фильтрация приведет
к потере некоторых высокочастотных деталей изображения).

\subsection{Восстановление изображений}
Самый простой подход к восстановлению изображения состоит в построении
приближения
вида $\hat F(u,v)=G(u,v)/H(u,v)$, после чего изображение восстанавливается:
$\hat f(x,y)\approx\IFT{F}$.
Такой метод называется\ж инверсной фильтрацией\н\index{Фильтрация!инверсная}.
Однако, вблизи нулей $H$ этот метод дает большие проблемы, кроме того он не
позволяет полностью избавиться от шума.

Более надежным методом является\ж винеровская
фильтрация\н\index{Фильтрация!Винеровская}. Винеровский фильтр
ищет приближение~$\hat f$, минимизирующее функцию $D=\aver{(f-\hat f)^2}$.
Решение этой задачи в частотной области зависит от спектра искажающей функции и
энергетического спектра шума~\look{Wnr}.

\begin{pict}
\includegraphics[width=.23\textwidth]{pic/Wnr-ori}\hspace*{2pt}
\includegraphics[width=.23\textwidth]{pic/Wnr-PSF}\hspace*{2pt}
\includegraphics[width=.23\textwidth]{pic/Wnr-SNR}\hspace*{2pt}
\includegraphics[width=.23\textwidth]{pic/Wnr-Full}\hspace*{2pt}
\caption{Винеровская фильтрация. Слева направо:
зашумленное и смазанное изображение шахматной доски;
его простейшая винеровская фильтрация (с использованием только информации об ФРТ шума);
фильтрация с учетом уровня сигнал/шум;
полная фильтрация}
\label{Wnr}
\end{pict}

Другим хорошо зарекомендовавшим себя методом линейного восстановления
изображений является\к фильтрация по методу наименьших квадратов с
ограничениями\н. Данный метод направлен на поиск минимума функции
$$C=\sum_{x,y}\Bigl(\nabla^2 f(x,y)\Bigr)^2,$$
при условии ограничения
$$||g-h\otimes\hat f||^2=||n||^2.$$
Здесь $||a||^2$~-- евклидова норма вектора (скалярный квадрат вектора).
Таким образом, для наиболее эффективной фильтрации указанным методом,
необходимо как можно лучше знать модель шума. При неизвестной модели шума
данный метод может быть неэффективным.

\subsection{Геометрические преобразования изображений}
Геометрические преобразования изображений сводятся к преобразованию масштаба
изображения, его повороту, а также нелинейным преобразованиям. Основные
геометрические преобразования аналогичны с поворотом и/или неравномерным
растяжением/сжатием куска резины, на который нанесено изображение, поэтому
иногда их называют преобразованиями куска резины.

Координатные преобразования удобно записывать в виде
$$(x,y)=T[(w,z)],$$
где $(x,y)$~-- координаты текущего пикселя преобразованного изображения,
$(w,z)$~-- координаты этого же пикселя исходного изображения, $T$~-- оператор
преобразования.

Чаще всего используется класс геометрических преобразований, представители
которого называются\; аффинными преобразованиями\н\index{Аффинные
преобразования}. Аффинное преобразование можно записать в матричной форме:
$$[x\;y\;1]=[w\;z\;1]\B{T}=[w\;z\;1]
\left[\begin{matrix}
t_{11}&t_{12}&0\\
t_{21}&t_{22}&0\\
t_{31}&t_{32}&1
\end{matrix}\right].
$$
Данное преобразование позволяет задать сжатие, поворот, сдвиг или перенос
изображения, в табл.~\ref{affin} перечислены значения коэффициентов
матрицы~$\B{T}$ для основных видов аффинных преобразований.
\begin{table}\begin{center}
\begin{tabular}{||c||c|c|c|c|c|c||}
\hline\hline
Тип преобразования&$t_{11}$&$t_{12}$&$t_{21}$&$t_{22}$&$t_{31}$&$t_{32}$\\
\hline
Тождество&1&0&0&1&0&0\\
Растяжение на вектор~$s$&$s_x$&0&0&$s_y$&0&0\\
Поворот на угол~$\theta$&$\cos\theta$&$\sin\theta$&$-\sin\theta$&$\cos\theta$&
0&0\\
Горизонтальный сдвиг ($x=w+\alpha z$)&
1&0&$\alpha$&1&0&0\\
Вертикальный сдвиг ($y=\alpha w+z$)&
1&$\alpha$&0&1&0&0\\
Перенос на вектор~$s$&1&0&0&1&$s_x$&$s_y$\\
\hline\hline
\end{tabular}\end{center}
\caption{Типы аффинных преобразований}
\label{affin}
\end{table}

Большинство вычислительных методов пространственного преобразования изображений
можно разделить на две категории: методы прямого и обратного отображения.

Методы\к прямого отображения\н копируют каждый пиксель~$(w,z)$ исходного
изображения в точку $(x,y)=T[(w,z)]$ результирующего изображения. При этом
возникает проблема, как скомбинировать несколько пикселей исходного
изображения, если они должны попасть в одну и ту же точку результирующего, или
как растянуть эти пиксели, чтобы между ними не было пробелов. Эту проблему
можно реализовать при помощи метода, располагающего четыре вершины каждого
пикселя исходного изображения в вершинах неправильного четырехугольника
выходного изображения. Входные пиксели распределяются относительно выходных
пропорционально площади перекрытия матрицы выходных пикселей такими
четырехугольниками. Однако, данный метод является довольно сложным, требуя
значительных вычислительных мощностей при реализации.

Алгоритм\к обратного отображения\н действует наоборот. Для каждого пикселя
выходного изображения вычисляется положение на входном изображении по формуле
$(w_0,z_0)=T^{-1}[(x,y)]$. Величина интенсивности в пикселе~$(x,y)$ вычисляется
методом интерполяции по ближайшим пикселям входного изображения. Реализация
обратного отображения значительно проще реализации прямого.

Процесс регистрации изображений требует применения аффинных преобразований.
Например, для получения панорамного снимка необходимо не только найти общие
точки соседних кадров, но и компенсировать аберрации и световые неоднородности,
возникающие при регистрации отдельного кадра.


\subsection{Вейвлет--преобразования изображений}
Аналогично одномерным сигналам, в двумерном пространстве также вводятся
вейвлет-преобразования. Фильтрация двумерными вейвлетами позволяет зачастую
добиться результатов, недоступных Фурье--фильтрации.

\bf Двумерные вейвлеты\н\index{Вейвлет!двумерный} вводятся на основе
одномерных~$\phi^{j,k}(x)$ и $\psi^{j,k}(x)$. Будем для краткости обозначать их
$\phi(x)$ и~$\psi(x)$.
Тогда из различных комбинаций произведений $\phi(x)$, $\phi(y)$, $\psi(x)$
и~$\psi(y)$ можно получить\к ядра двумерных вейвлетов\н:
горизонтальное, $\psi^H(x,y)=\psi(x)\phi(y)$, вертикальное,
$\psi^V(x,y)=\phi(x)\psi(y)$, и диагональное, $\psi^D(x,y)=\psi(x)\psi(y)$.
Двумерная функция $\phi(x,y)=\phi(x)\phi(y)$ называется\к масштабирующей
функцией\н.

Подобно преобразованию Фурье, вейвлет--преобразования применяются при обработке
цифровых изображений в следующем порядке:
\begin{enumerate}
\item вычисление двумерного вейвлет--преобразования изображения;
\item внесение изменений в коэффициенты преобразования;
\item вычисление обратного вейвлет--преобразования.
\end{enumerate}

При помощи вейвлет--преобразований можно, например, выделить контуры
изображения, осуществить сглаживание изображения, масштабировать изображение,
осуществлять сжатие изображений.


\subsection{Распознавание объектов}\index{Распознавание}
Особой проблемой в области цифровых изображений является распознавание объектов.
Распознавание объектов применяется в системах распознавания печатного текста,
системах электронного зрения, охранных системах, системах дорожного
видеонаблюдения и многих других. Методика распознавания базируется как на
корреляционных функциях (поиск максимума корреляции изображения с образцом), так
и на адаптивных системах, использующих элементы искусственного интеллекта.

Многие системы распознавания основаны на изучении\ж скелетов\н изображения~---
своего рода каркасов, на которые <<натянуты>> детали изображения. Со скелетами
проще проводить операции аффинных преобразований, что помогает распознавать
повернутый или имеющий другой масштаб образец.

Наиболее простой методикой распознавания объектов является корреляционное
сопоставление. Корреляционная задача заключается в нахождении позиций на
изображении~$f(x,y)$, которые лучше всего соответствуют заданному
подызображению~$w(x,y)$, называемому маской или эталоном.
Однако, нахождение свертки $w(x,y)$ с~$f(x,y)$ зачастую требует значительных
вычислительных мощностей, поэтому практические реализации корреляционной
процедуры основываются на специфических аппаратных решениях, простейшим из
которых является связь свертки с произведением Фурье--образов сворачиваемых
функций (операция нахождения быстрого Фурье--преобразования двух изображений,
их произведение и нахождение обратного быстрого Фурье--преобразования занимает
значительно меньше машинного времени).

Техника\к структурного распознавания\н базируется на общем представлении
интересующих объектов в виде строк, деревьев или графов набора дескрипторов и
правил распознавания на основе выбранного представления объектов.
