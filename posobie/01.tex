\lr{Статистика и вероятность. Случайные величины и распределения\label{Statistics}} % 2 часа
\theory
\bf Случайной величиной\н называется величина~$X$, если все ее возможные значения
образуют конечную или бесконечную последовательность чисел~$x_1,\ldots$, $x_N$,
и если принятие ею каждого из этих значений есть случайное событие.\ж Вероятностью\н
наступления данного случайного события~$x_k$ называется предел относительной частоты
наступления данного события~$n_k/N$:
$$P(x_k)=\lim_{N\to\infty}\frac{n_k}{N}.$$

Случайная величина может быть не только дискретной, но и\ж непрерывной\н. В этом случае
она может принимать любое значение из заданной области действительных чисел. Непрерывная
случайная величина характеризуется\ж плотностью вероятности\н:
$$\phi(x)=\lim_{\Delta x\to 0}\frac{P(x<X<x+\Delta x)}{\Delta x}=\frac{dP}{dx}.$$
Вероятность попадания значений~$X$ в интервал~$(x_1,x_2)$ можно вычислить по формуле:
$$P(x_1<X<x_2)=\Int_{x_1}^{x_2}\phi(x)\,dx.$$
Вероятность того, что значения случайной величины не превышают заданного числа~$x$
называют\ж функцией распределения\н:
$F(x)\equiv P(X\le x)=\Int_{-\infty}^x\phi(x)\,dx$.
Так как вероятность попадания значений~$(X)$ в промежуток~$(-\infty,\infty)$ равна
единице, плотность вероятности должна быть\ж нормирована\н:
$$\Infint\phi(x)\,dx=1.$$

Две случайные величины~$X$ и~$Y$ называются\ж независимыми\н, если наступление одного
из событий~$x_n$ никак не сказывается на результате события~$y_n$. В этом случае
вероятность совместного наступления событий~$x_n$ и~$y_n$ равна $P(x_ny_n)=P(x_n)P(y_n)$.
Дальнейшие формулы в этом разделе подразумевают независимость входящих в них случайных
величин, если зависимость не указана явно.

Набор случайных величин~$X$ можно охарактеризовать\ж средним арифметическим\н:
$\aver{X}=\frc1{N}\sum_{n=1}^N x_n$. Для малых~$N$ данная величина будет отличаться
от\ж математического ожидания\н, определяемого по формуле
$$M(X)\equiv\mean{X}=\lim_{N\to\infty}\frac1{N}\sum_{n=1}^N x_n\quad\text{и}\quad
M(X)=\Infint x\phi(x)\,dx,$$
однако\ж закон больших чисел\н говорит, что чем большей является величина~$N$, тем
ближе~$\aver{X}$ к~$\mean{X}$.

Помимо математического ожидания набор случайных величин характеризуется медианой и
модой.\ж Мода\н~--- значение во множестве наблюдений, которое встречается наиболее часто.
Иногда мод может быть больше одной. В этом случае можно сказать, что совокупность\к
мультимодальна\н. Как правило мультимодальность указывает на то, что набор данных не
подчиняется нормальному распределению.\ж Медиана\н~--- возможное значение признака,
которое делит отсортированную совокупность на две равные части: 50\%~<<нижних>> единиц
ряда данных будут иметь значение признака не больше, чем медиана, а 50\%~<<верхних>>~---
значения признака не меньше, чем медиана.

\it Свойства математического ожидания\н: $M(\sum\C_n\cdot X_n)=\sum\C_n\cdot M(X_n)$,
где $\C_n$~-- постоянная величина; $M(\prod X_n)=\prod M(X_n)$;
$M(f(x))=\Infint f(x)\phi(x)\,dx$.
Если $f(x)=(x-x_0)^n$, говорят, что~$M(f(x))$ является\ж моментом\н случайной величины
порядка~$n$. При~$x_0=0$ момент называют\ж начальным\н, а при~$x_0=\mean{X}$~---\ж
центральным\н.

Центральный момент второго порядка называют\ж дисперсией\н:~$D(X)=\mean{(x-\mean{x})^2}$.
Разброс случайной величины относительно математического ожидания характеризуется\ж
средним квадратичным отклонением\н~$\sigma=\sqrt{D}$. Дисперсию можно вычислить
и по упрощенному выражению:
$$D=\mean{(x-\mean{x})^2}=\mean{x^2}-\mean{2x\mean{x}}+\mean{\mean{x}^2}=
\mean{x^2}-\mean{x}^2\equiv M(x^2)-[M(x)]^2.$$

\next
Если функция плотности вероятности случайного события описывается аналитически, говорят,
что она подчинена некоторому\ж распределению\н. Наиболее известными видами распределения
являются непрерывное, нормальное (гауссово), Пуассона, биномиальное, экспоненциальное
и многие другие.

Говорят, что случайная величина имеет непрерывное\ж равномерное распределение\н на
отрезке~$[a,b]$, где~$a$,~$b\in\mathbb{R}$, если ее плотность $\phi(x)$ имеет вид
$$
\phi(x)=\begin{cases}\frac1{b-a}, & x\in [a,b] \\ 0, & x\not\in [a,b]
\end{cases}.
$$
Интегрируя, получим, для~$F(x)$:
$$F(x)= \begin{cases} 0, & x < a \\ {x-a \over b-a}, & a \le x < b \\ 1, & x \ge b \end{cases}.
$$
Математическое ожидание и медиана для равномерного распределения совпадают с серединой
отрезка~$[a,b]$, модой же является любое значение из этого отрезка.

Важнейшую роль в физике имеет\ж нормальное\н~(гауссово) распределение. Физическая
величина подчиняется нормальному распределению, когда она подвержена влиянию огромного
числа случайных помех. Плотность вероятности нормального распределения имеет вид:
$$
\phi (x) = \frac 1 {\sigma \sqrt {2 \pi}} \exp \left( -\frac {(x -\mean{x})^2}{2 \sigma^2} \right),
$$
Функция распределения записывается через\к интеграл Римана\н:
$$
F (x) = \frac 1{\sigma \sqrt {2 \pi}} \Int_{-\infty}^x \exp \left( -\frac{(t
-\mean{x})^2}{2 \sigma^2} \right)\, dt.
$$
Особенностью нормального распределения является совпадение медианы, моды и математического
ожидания.

Вероятность того, что нормальная случайная величина с параметрами~$\mean{x}$ и~$\sigma$
попадет в интервал $(\alpha,\beta)$ равна:
$$
P(\alpha < X < \beta) = \Phi\Bigl( \frac {\beta - \mean{x}} {\sigma}\Bigr) -
\Phi\Bigl( \frac {\alpha - \mean{x}} {\sigma}\Bigr),
$$
где $\Phi(x)$~--\ж функция Лапласа\н:
$$
\Phi(x)= \frac 1 {\sqrt {2 \pi}} \Int _{0}^x \exp \left( -\frac {t^2} {2} \right) dt.
$$

\next
Для выяснения зависимости случайных величин~$X$ и~$Y$ используются такие функции, как
корреляция и ковариация.\ж Ковариация\н является мерой линейной зависимости случайных
величин и определяется формулой: $\mathrm{cov}(X,Y)=\mean{(X-\mean{X})(Y-\mean{Y})}$.
Понятно, что ковариация величины с самой собой есть ее дисперсия.\к Ковариация
независимых случайных величин равна нулю\н, обратное неверно.

\bf Коэффициент корреляции\н двух величин задается формулой
$$
\rho_{X,Y} = \frac{\mathrm{cov}(X,Y)}{\sqrt{D(X) \cdot D(Y)}}.
$$
\it Коэффициент корреляции равен~$\pm1$ тогда и только тогда, когда~$X$ и~$Y$ линейно
зависимы\н. Если они независимы, $\rho_{X,Y}=0$. Промежуточные значения коэффициента
корреляции не позволяют однозначно судить о зависимости случайных величин, но
позволяет предполагать степень их зависимости.

Для непрерывных величин аналогом коэффициента корреляции является\к корреляционная
функция\н. Более часто применяют ее разновидность~---\ж автокорреляционную
функцию\н:
$$
\Psi(\tau) = \Int f(t) f(t-\tau)\, dt,
$$
показывающую связь сигнала (функции $f(t)$) с копией самого себя, смещенного на
величину~$\tau$.
Автокорреляционная функция имеет обычно максимум при~$t=0$. Имея два сигнала,
представляющих собой исходный и сдвинутый на неизвестную величину~$z$, можно
определить~$z$ из корреляционной функции: эту величину однозначно покажет положение
максимума корреляционной функции.

\next
В теории сигналов вводят понятие шума.\ж Шум\н~--- беспорядочные колебания различной
физической природы, отличающиеся сложностью временной и спектральной структуры.
Наиболее общим видом шума является\ж белый шум\н~--- стационарный шум, спектральные
составляющие которого равномерно распределены по всему диапазону задействованных частот.
В природе и технике <<чисто>> белый шум (то есть белый шум, имеющий одинаковую
спектральную мощность на всех частотах) не встречается (ввиду того, что\к такой сигнал
имел бы бесконечную мощность\н), однако под категорию белых шумов попадают любые шумы,
спектральная плотность которых одинакова (или слабо отличается) в рассматриваемом
диапазоне частот.
Белым шумом является любой шум с фиксированной дисперсией, нулевым математическим
ожиданием и автокорреляционной функцией, имеющей вид\к дельта-функции Дирака\н. Чаще
всего белый шум моделируют гауссовским распределением, т.к. такая модель
хорошо подходит для математического описания многих природных процессов.

Зашумленность сигнала характеризуют\ж отношением сигнал/шум\н~(SNR):
$$
\mathrm{SNR} = {P_\mathrm{signal} \over P_\mathrm{noise}} = \left ( {A_\mathrm{signal} \over A_\mathrm{noise} } \right )^2,
$$
где $P$ и~$A$~--- соответственно, средняя мощность и среднеквадратичное значение
амплитуды сигнала и шума. Зачастую~SNR выражают в~децибелах:
$$
\mathrm{SNR (dB)} = 10 \lg \left ( {P_\mathrm{signal} \over P_\mathrm{noise}} \right )
= 20 \lg \left ( {A_\mathrm{signal} \over A_\mathrm{noise}} \right ).
$$
Причина множителя 10 становится понятной, исходя из приставки <<деци>>, а множитель~20
возникает вследствие умножения на 2, появляющегося при логарифмировании амплитуд.


\pract
На этом занятии познакомимся со средой матричных вычислений Matlab и научимся
выполнять в ней простейшие манипуляции с данными.

Название <<Matlab>> подразумевает работу с матрицами. Соответственно, все данные
в Matlab представлены в матричной форме.\к Этого не следует забывать при выполнении
различных операций\н! Чтобы присвоить переменной~$A$ значение 10.5,
достаточно написать: \verb'A=10.5'. На экране тут же отобразится значение
переменной~$A$.\к Для подавления вывода следует заканчивать команды точкой с
запятой\н. Попробуйте набрать теперь \verb'A=10.5;' заметили разницу?

Если вы хотите инициализировать эту переменную
вектором, напишите, например: \verb'A=[1 2 3]' или же \verb'A=[1,2,3]'. Вы
получите вектор-строку с элементами~1, 2 и~3. Таким образом, перечислять элементы
строки можно либо через запятую, либо через пробел. Чтобы получить вектор-столбец,
следует разделять его элементы точкой с запятой: \verb'A=[1;2;3]'.
И, наконец, для ввода матриц: разделяйте элементы строки запятыми или пробелами,
а строки~--- точкой с запятой. Введем единичную матрицу:
$$\verb'A=[1 0 0;0 1 0;0 0 1]'$$
на экране отобразится:
\begin{verbatim}
A=
    1  0  0
    0  1  0
    0  0  1
\end{verbatim}


Для обращения к элементу матрицы необходимо набрать его имя и в скобках указать
либо абсолютный номер, либо\к номер строки, а затем номер столбца\н. Наберите
теперь \verb'A(5)', а после~--- \verb'A(2,2)'. На экране отобразится один и
тот же текст: \verb'ans=1'. И действительно, пятый по счету элемент соответствует
элементу второй строки второго столбца. Программистам следует обратить внимание,
что\к номера массивов начинаются с единицы\н, в отличие от языков программирования,
где первому элементу соответствует ноль.

Допустим, у вас есть матрица-строка, а вы хотите сделать матрицу-столбец. Для
этого используйте операцию транспонирования: наберите \verb'x=[1 2 3]', а затем
\verb"x'". Как видите, добавление после имени матрицы апострофа означает
операцию транспонирования.

\bf Диапазоны данных\н можно указывать, разделяя числа двоеточием. Так,
\verb'[1:10]' дает набор целых чисел от~1 до~10, а \verb'[1:0.5:10]'~---
то же, но с шагом в~$0.5$.

Теперь создайте еще одну матрицу
$$\verb'a=[0 1 0;1 0 1;0 1 0]'$$
Заодно обратите
внимание:\к в Matlab имена переменной зависят от регистра\н! Для произведения
простейших операций над матрицами используйте операторы +, -, / и \verb'*'.
Наберите поочередно \verb'A+a', \verb'A-a', \verb'A*a', \verb'A/a'. Обратите
внимание, что при этом производятся именно матричные операции. Поэтому необходимо
согласовывать размеры матриц (вспомните курс алгебры). Еще одним, чисто матричным
оператором, является оператор левого деления \verb'\', использующийся при
решении систем уравнений. Кроме того, используется оператор возведения в
степень, \verb'^'.

Но, допустим, вы захотите произвести поэлементное умножение или деление матриц.
В этом случае\к до символа операции наберите точку\н. Например, попробуйте
набрать \verb'A./a'. Попробуйте эти операции с более осмысленными векторами или
матрицами.

Если вы присвоили переменной\к одно\н значение, все вычисления с ней выполняются
как со скаляром.

Кроме чисел в Matlab есть понятия бесконечности (\verb'Inf') и не-числа
(\verb'NaN'). Вы можете присвоить эти величины переменным. Обратите внимание, что
\verb'NaN' соответствует неопределенным операциям, например, пределам вида $0/0$,
$\infty/\infty$ и т.п. (однако, попробуйте операцию \verb'Inf/0').
В отличие от \verb'Inf', \verb'NaN' инвариантен относительно любых операций.

Еще одним удобством является дополнение команд и <<история команд>> в стиле UNIX. Набирая
команду и нажимая клавишу Tab вы упростите себе работу: если вариант дополнения
только один, Matlab закончит команду, иначе~--- выведет окно выбора со списком
возможных команд. Клавишами $\uparrow$ и $\downarrow$ можно перемещаться по
истории команд, что полезно, если вам надо набирать много однотипных длинных
команд, отличающихся незначительно.

В Matlab существует огромное количество функций. Обычно они имеют
стандартный синтаксис типа \verb'A=funk(b,...)': аргументы функции помещаются
в скобки, а ее значение приравнивается матрице. Помощь по функции \verb'funk' можно
получить командой \verb'help funk' или нажав клавишу \verb'F1' и воспользовавшись
гипертекстовой системой помощи.

\next
Теперь познакомимся с командой \verb'rand'. Эта команда\к генерирует равномерно
распределенные случайные числа из диапазона~$[0,1]$\н. Создайте вектор-строку из ста случайных чисел
командой \verb'a=rand(1,100);'. Не забывайте писать в конце команд точку с запятой,
иначе вывод (особенно для больших массивов) может занять длительное время.
Командой \verb'x=rand(100,100)' можно создать массив из $100\times100$ случайных
чисел. Аналогично ведет себя команда \verb'x=rand(100)'.

Для\ж отображения графиков\н в Matlab есть команда \verb'plot'. Если ей задан
один аргумент, она отображает по оси X номер элемента, а по Y~--- его значение.
Если задать аргументами массивы\к одинаковой\н длины, первый используется как
значения оси X, второй~--- Y. Постройте график \verb'plot(a)'. Убедились,
что $a$~--- массив совершенно случайных чисел?

Команда \verb'mean(a)' вернет среднее арифметическое значение переменной $a$\к
по столбцам\н. Вторым аргументом команды можно указать, по какому именно
столбцу мы хотим усреднить массив~$a$.
Найдите среднее значение своего вектора. Отобразите на графике все значения
и их среднее командой
$$\verb'plot([1:100], a, [1:100], mean(a))'$$
Если точки двух графиков по оси X совпадают (как в предыдущем случае),
можно укоротить запись:
$$\verb'plot([1:100],[a; mean(a)])'$$
(команда \verb'plot', если задать ей в качестве аргумента матрицу, изображает
разными цветами графики функций, соответствующих каждой строке матрицы).

Функция \verb'normpdf(X,x,s)' позволяет построить график нормального распределения,
соответствующий вектору координат X, для математического ожидания x и среднего
квадратичного отклонения s. Наберите
$$\verb'x=[-70:30]; y=normpdf(x,-20,20);'$$
а затем~--- \verb'plot(x,y)'. На графике вы увидите плотность вероятности нормально
распределенной случайной величины с математическим ожиданием -20 и среднеквадратичным
отклонением~20.

Сгенерируем синусоидальный сигнал на участке~$[0,2\pi]$
командами
$$\verb'x=[0:pi/50:2*pi]; y=sin(x);'$$
Теперь добавим к сигналу
гауссов белый шум с амплитудой 10~дБ относительно амплитуды сигнала:
$$\verb"y1=awgn(y,10,'measured'); plot(x, [y; y1])"$$
Третий параметр (measured) обязателен, т.к. без него процесс добавления
шума будет несколько иным (мощность сигнала будет считаться равной 0~дБ), можете
проверить на синусоиде с амплитудой~10.

\next
Для генерации синусоидального сигнала $y_0=A\sin(2\pi t/T)$ с амплитудной модуляцией
по закону $y_1=f(t)$ необходимо перемножить эти две функции: $y=y_0\cdot y_1$.
Промодулируем синусоиду с периодом $\pi/5$ пилообразным сигналом с периодом~10
на интервале $x\in[0,20]$.
Для генерирования <<пилы>> используется функция \verb'sawtooth'. Если задать
ей один аргумент (вектор $x$), период будет равен~$2\pi$, а сигнал будет
изменяться в интервале $[-1,1]$. Чтобы задать смещение максимума, равное $a\cdot2\pi$,
необходимо указать: \verb'y=sawtooth(x,a)'. Таким образом, чтобы получить
<<пилу>> с интервалом сигнала в $[0,1]$ и периодом~10, необходимо дать команду
\verb'y1=0.5+sawtooth(x*2*pi/10)/2;'. Следовательно, получить наш сигнал можно
командой
$$\verb'y=sin(x*10).*(0.5+sawtooth(x*pi/5)/2);'$$
(не забудьте про точку перед знаком умножения между функциями, иначе
получите ошибку, т.к. Matlab попытается перемножить два вектора--строки).

\next
Создадим теперь две синусоиды, сдвинутые на три единицы:
\verb'x=[0:0.05:20];' \verb'y=sin(x);'
\verb'y1=sin(x+3);'. Попробуем определить, на сколько единиц сдвинут первый
сигнал относительно второго. Для этого воспользуемся корреляционной функцией.
Запишем \verb'Corr=xcorr(y,y1)'. Корреляционная функция в данном случае имеет
вдвое большую ширину, чем исходная, т.к. она получается путем последовательного
сдвига второй функции относительно первой. Поэтому построим график командой
\verb'plot([-20:0.05:20],Corr)'. Воспользовавшись функцией увеличения можно
увидеть, что ближайший к нулю максимум соответствует сдвигу одной функции
относительно другой. В нашем случае сигнал был периодическим, поэтому при
сдвигах на величины, превышающие половину периода, возникает ошибка, кратная
полупериоду. Это необходимо учитывать в расчетах.

\self
\begin{enumerate}
\item Найдите сумму, разность, произведение и частное матриц
$$A=\begin{pmatrix}1&2&3\\6&5&4\\9&8&7\end{pmatrix},\qquad
B=\begin{pmatrix}9&8&7\\5&3&1\\0&2&6\end{pmatrix}.$$
Найдите определители исходных и получившихся матриц (команда \verb'det(A)').

\item
Найдите значение почленного, матричного и скалярного произведений векторов
$a=(2,5,7)$ и $b=(11,13,17)$. Скалярное произведение найдите двумя способами:
путем перемножения векторов и при помощи функции \verb'dot(a,b)'.
Найдите векторное произведение $a\times b$ при помощи функции
\verb'cross(a,b)'.

\item
Постройте график нормального распределения на интервале $[0,100]$ с математическим
ожиданием~50 и дисперсией~100.

\item
\label{noicy_AM}
Получите сигнал с амплитудной модуляцией (из примера). Добавьте к нему гауссов
белый шум с SNR 100, 50, 10 и~1~дБ. Постройте отдельно графики всех
полученных сигналов. Можно ли сделать какой-либо вывод о виде сигнала при
SNR=1? Как вы думаете, можно ли восстановить из него исходный сигнал?

\item
Для полученного сигнала найдите следующие характеристики: математическое ожидание
(\verb'mean'), среднее квадратичное отклонение (\verb'std'), медиану (\verb'median')
и моду (\verb'mode'). Найдите аналогичные величины для разности между зашумленным
и оригинальным сигналом. Сравните полученные величины с теоретическими.

\item
Попытайтесь определить сдвиг двух синусоид (из примера) при зашумлении:
\begin{itemize}
\item только одной с уровнем сигнал/шум 1~дБ;
\item обеих с уровнем SNR=1~дБ;
\item одной с уровнем SNR=0.1~дБ;
\item обеих с уровнем SNR=0.1~дБ.
\end{itemize}
Постройте один из сигналов с SNR=0.1~дБ. Можно ли определить его период?
Можно ли определить период по автокорреляционной функции этого сигнала?
\end{enumerate}

\qwest
\begin{enumerate}
\item Что называют случайной величиной? Вероятностью? Плотностью вероятности?
В чем отличие непрерывных и дискретных случайных величин?
\item Что такое функция распределения вероятности? Для чего используется
нормировка функции распределения?
\item Дайте определения медианы, моды, математического ожидания,
дисперсии и среднеквадратичного отклонения.
\item Можно ли считать равными среднее арифметическое и математическое
ожидание? Какой закон описывает сходство этих величин?
\item Что называют центральными, начальными моментами? Чему равен центральный
момент первого порядка?
\item Какие основные распределения случайных величин вы знаете?
Какому распределению подчиняются большинство физически наблюдаемых
случайных величин?
\item Для чего используется функция Лапласа?
\item Что такое ковариация, корреляция? Для чего при расчете коэффициента
корреляции ковариацию делят на среднее геометрическое дисперсий случайных
величин?
\item Для чего при исследовании двух сигналов применяется корреляционная функция?
\item Дайте определение белого шума. Почему шум такого вида не существует в
природе?
\item Какая характеристика описывает чистоту сигнала? Объясните, от чего зависит
коэффициент при расчете этой характеристики в логарифмической шкале.
\item Дайте определения скалярного, векторного и тензорного произведения
двух векторов. Как в MatLab реализуются эти операции?
\end{enumerate}
